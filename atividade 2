#include <stdio.h>
#include <locale.h>
#include <ctype.h>
#include <stdlib.h>


int manhattan(int x1, int y1, int x2, int y2){
    int dx = x1 - x2; if (dx < 0) dx = -dx;
    int dy = y1 - y2; if (dy < 0) dy = -dy;
    return dx + dy;
}

void imprimi_instrucoes(){
    printf("\nComo jogar:\n");
    printf("\nVocê é a letra S e seu objetivo é chegar a letra G (ponto final).\n");
    printf("\nVocê só pode andar pelos (.)\n(#) são paredes!\n");
    printf("\nPara andar com seu robo (S)\n");
    printf("Segue os comandos\n-W(para cima) \n-S(para baixo) \n-A(para esquerda)");
    printf("\n-D(para direita) \n\nSe quiser parar o jogo digite Q (quit)\n\n");
}

int validaCaminho(char matriz[7][7], int linha, int coluna, int *prox[3], char valid){
    int cal_aux = manhattan(linha,coluna, 4, 5);
    
    if(matriz[linha][coluna]==valid || matriz[linha][coluna]=='G'){
        if(cal_aux<=prox[2]){
            prox[0]=linha;
            prox[1]=coluna;
            prox[2]=cal_aux;
        }
    }
    
}

void imprimi_matriz(int linha,int coluna,char vet[linha][coluna]){
    for (int i=0;i<linha;i++){
        for(int j=0;j<coluna;j++){
           printf("%c   ",vet[i][j]);
        }
        printf("\n\n");
    }
}

int main(){
    //Estou criando uma matriz para representar o labirinto.
     char direcao;
     int dx,dy,cal_m,linha,coluna;
     int prox[3];
     int robo[2]={1,1};//Criei a variavel robo para percorrer o jogo.
     char matriz[7][7] = {//linhas e colunas de # para deixar a matriz mais "bonita"
        {'#','#', '#', '#','#','#','#'},
        {'#','S', '.', '.','#','.','#'},
        {'#','.', '#', '.','#','.','#'},
        {'#','.', '#', '.','.','.','#'},
        {'#','.', '.', '.','#','G','#'},
        {'#','.', '#', '.','.','.','#'},
        {'#','#', '#', '#','#','#','#'}
    };
    
    cal_m=manhattan(robo[0], robo[1], 4, 5);
    
    printf("\n------------------------------\n");
    printf("\nBem vindo ao jogo do labirinto\n");
    printf("\n------------------------------\n\n\n");//estética
    https://www.onlinegdb.com/#tab-stdin

    while(1){
        printf("\nCalculo de Manhattan: %d\n",cal_m);
        imprimi_matriz(7, 7,matriz);
        
        printf("\nDigite a direção desejada:\n\n");
        scanf("%s",&direcao);

        linha=robo[0];
        coluna=robo[1];
        
        prox[0]=linha;
        prox[1]=coluna;
        prox[2]=200000;
        
        
        validaCaminho(matriz, linha-1,coluna, &prox, '.');
        
        validaCaminho(matriz, linha+1,coluna, &prox, '.');
        
        validaCaminho(matriz, linha,coluna-1, &prox, '.');
        
        validaCaminho(matriz, linha,coluna+1, &prox, '.');
        
        
        if(linha==prox[0] && coluna==prox[1]){
            printf("\nPassei:\n");
            validaCaminho(matriz, linha-1,coluna, &prox, '*');
        
            validaCaminho(matriz, linha+1,coluna, &prox, '*');
            
            validaCaminho(matriz, linha,coluna-1, &prox, '*');
            
            validaCaminho(matriz, linha,coluna+1, &prox, '*');
        }
        
        
        
        
        
        matriz[linha][coluna] = '*';
        robo[0] = prox[0];
        robo[1] = prox[1];
        cal_m = prox[2];
        
        printf("\nTESTE LINHA: %d\n",robo[0]);
        printf("\nTESTE Coluna: %d\n",robo[1]);
        
        if(matriz[robo[0]][robo[1]]=='G'){
            printf("Você chegou no final do jogo!");
            break;
        }else{
            matriz[robo[0]][robo[1]] = 'S';  
        }
        
    }
    return 0;
}

